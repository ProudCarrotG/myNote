/*
BUILT_AT: 2021年9月15日 07:59
*/
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.push_message=t():e.push_message=t()}("undefined"!=typeof self?self:this,(function(){return function(e){function t(t){for(var i,a,c=t[0],s=t[1],u=t[2],l=0,d=[];l<c.length;l++)a=c[l],Object.prototype.hasOwnProperty.call(o,a)&&o[a]&&d.push(o[a][0]),o[a]=0;for(i in s)Object.prototype.hasOwnProperty.call(s,i)&&(e[i]=s[i]);for(f&&f(t);d.length;)d.shift()();return r.push.apply(r,u||[]),n()}function n(){for(var e,t=0;t<r.length;t++){for(var n=r[t],i=!0,c=1;c<n.length;c++){var s=n[c];0!==o[s]&&(i=!1)}i&&(r.splice(t--,1),e=a(a.s=n[0]))}return e}var i={},o={3:0},r=[];function a(t){if(i[t])return i[t].exports;var n=i[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=i,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)a.d(n,i,function(t){return e[t]}.bind(null,i));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="//s1.hdslb.com/bfs/static/blive/blfe-message-navbar/";var c=("undefined"!=typeof self?self:this).webpackJsonppush_message=("undefined"!=typeof self?self:this).webpackJsonppush_message||[],s=c.push.bind(c);c.push=t,c=c.slice();for(var u=0;u<c.length;u++)t(c[u]);var f=s;return r.push([272,0,1]),n()}({104:function(e,t,n){"use strict";var i=n(2),o=n(81).charAt;i({target:"String",proto:!0,forced:n(8)((function(){return"𠮷"!=="𠮷".at(0)}))},{at:function(e){return o(this,e)}})},115:function(e,t){},15:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return c}));n(3),n(21),n(31),n(22),n(43),n(34);var i={getItem:function(e){return decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null},setItem:function(e,t,n,i,o,r){if(!e||/^(?:expires|max\-age|path|domain|secure)$/i.test(e))return!1;var a="";if(n)switch(n.constructor){case Number:a=n===1/0?"; expires=Fri, 31 Dec 9999 23:59:59 GMT":"; max-age="+n;break;case String:a="; expires="+n;break;case Date:a="; expires="+n.toUTCString()}return document.cookie=encodeURIComponent(e)+"="+encodeURIComponent(t)+a+(o?"; domain="+o:"")+(i?"; path="+i:"")+(r?"; secure":""),!0},removeItem:function(e,t,n){return!(!e||!this.hasItem(e))&&(document.cookie=encodeURIComponent(e)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT"+(n?"; domain="+n:"")+(t?"; path="+t:""),!0)},hasItem:function(e){return new RegExp("(?:^|;\\s*)"+encodeURIComponent(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=").test(document.cookie)},keys:function(){for(var e=document.cookie.replace(/((?:^|\s*;)[^\=]+)(?=;|$)|^\s*|\s*(?:\=[^;]*)?(?:\1|$)/g,"").split(/\s*(?:\=[^;]*)?;\s*/),t=0;t<e.length;t++)e[t]=decodeURIComponent(e[t]);return e}};n(18);var o=function(){try{if("undefined"!=typeof navigator&&/Firefox\/(\d+)/i.test(navigator.userAgent))return navigator.userAgent.match(/Firefox\/(\d+)/i)[1]>=65;var e=document.createElement("canvas");return!(!e.getContext||!e.getContext("2d"))&&0===e.toDataURL("image/webp").indexOf("data:image/webp")}catch(e){return!1}}(),r="undefined"!=typeof window?window.navigator.userAgent:"",a={myBrowser:"unknown",behaviors:[function(){return!!r.match(/Maxthon\/[4]/)&&"Maxthon 4"},function(){return!!r.match(/TheWorld/)&&"TheWorld"},function(){return!!r.match(/Firefox\/\d.*/)&&"Firefox"},function(){return!(!r.match(/AppleWebKit\/\d.*.Chrome\/\d.*.Safari\/\d/)||"Google Inc."!==window.navigator.vendor||!window.chrome)&&"Chrome"},function(){return!!r.match(/Opera.\d.*.Presto\/\d/)&&"Opera Presto"},function(){return!!r.match(/OPR\/\d{2}/)&&"Opera Modern"},function(){return!!r.match(/MSIE [6-8].+/)&&"IE Legacy"},function(){return!(!r.match(/MSIE [9].+/)||"function"!=typeof window.ScriptEngine||"JScript"!==window.ScriptEngine())&&"IE 9"},function(){return!(!r.match(/MSIE [10].+/)||"function"!=typeof window.ScriptEngine||"JScript"!==window.ScriptEngine())&&"IE 10"},function(){return!(!r.match(/Trident\/[7].*.rv:11/)||"function"!=typeof window.ScriptEngine||"JScript"!==window.ScriptEngine())&&"IE 11"},function(){return!(!r.match(/Edge\/\d+\.\d+/)||"function"!=typeof window.StyleMedia)&&"Edge"},function(){return!(!r.match(/AppleWebKit\/\d.*.Mobile.*Safari\/\d+/)||"Apple Computer, Inc."!==window.navigator.vendor)&&"SafariMobile"},function(){return!(!r.match(/AppleWebKit\/\d.*.Safari\/\d+/)||"Apple Computer, Inc."!==window.navigator.vendor)&&"Safari"}]};var c=function(){return"undefined"==typeof window?"":(a.behaviors.some((function(e){var t=e();return a.myBrowser=t||"unknown",t})),a.myBrowser)};n(112),n(26),n(51)},227:function(e,t,n){},272:function(e,t,n){"use strict";n.r(t);var i=n(11),o=n.n(i),r=(n(227),n(1)),a=n.n(r),c=(n(32),n(4),n(9),n(41),n(42),n(16),n(104),n(43),n(106),n(44),n(7)),s=function(e){var t=""+document.cookie,n=t.indexOf(e+"=");if(-1==n||""==e)return"";var i=t.indexOf(";",n);return-1==i&&(i=t.length),unescape(t.substring(n+e.length+1,i))},u={"zh-CN":{replyMe:"回复我的",atMe:"@我的",praiseMe:"收到的赞",system:"系统通知",whisper:"我的消息"},"zh-TW":{replyMe:"回复我的",atMe:"@我的",praiseMe:"收到的讚",system:"系統通知",whisper:"我的消息"}};function f(e){return(t=s("LNG")||"zh-CN",u[t]||{})[e]||e;var t}var l=n(63),d=n.n(l);function p(e,t,n,i,o,r,a){try{var c=e[r](a),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(i,o)}function m(e){return function(){var t=this,n=arguments;return new Promise((function(i,o){var r=e.apply(t,n);function a(e){p(r,i,o,a,c,"next",e)}function c(e){p(r,i,o,a,c,"throw",e)}a(void 0)}))}}var h={data:function(){return{uid:"",notifyCounts:{at_me:0,reply_me:0,praise_me:0,notify_me:0,message:0},notifyType:3,showUnfollowedMsg:1,readyToPost:!1,im_list:[{name:"reply_me",text:f("replyMe"),href:"//message.bilibili.com/#/reply"},{name:"at_me",text:f("atMe"),href:"//message.bilibili.com/#/at"},{name:"praise_me",text:f("praiseMe"),href:"//message.bilibili.com/#/love"},{name:"notify_me",text:f("system"),href:"//message.bilibili.com/#/system"},{name:"message",text:f("whisper"),href:"//message.bilibili.com/#/whisper"}]}},watch:{notifyCounts:{handler:function(){this.postMessage()},deep:!0},notifyType:function(){this.postMessage()}},mounted:function(){var e=this;return m(a.a.mark((function t(){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all([e.getUid(),e.getNotifyType(),e.getnotifyCounts()]);case 2:return t.next=4,e.getUnreadMessageCount(!0);case 4:setInterval((function(){e.getUnreadMessageCount()}),6e4),window.addEventListener("storage",(function(t){t.key==="imNotifyCounts".concat(e.uid)?e.notifyCounts=JSON.parse(t.newValue):t.key==="im_notify_type_".concat(e.uid)&&(e.notifyType=parseInt(t.newValue))}));case 6:case"end":return t.stop()}}),t)})))()},methods:{getUid:function(){var e=this;return d.a.get().then((function(t){e.uid=t.data.mid}))},getUnreadMessageCount:function(){var e=arguments,t=this;return m(a.a.mark((function n(){var i,o,r;return a.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:i=e.length>0&&void 0!==e[0]&&e[0],o=function(){var e=m(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(c.a)({addPlatInfo:!0,url:"//api.vc.bilibili.com/session_svr/v1/session_svr/single_unread",method:"get",data:{unread_type:0}}).then((function(e){var n,i,o;return t.unfollowFold?(null===(n=e.data)||void 0===n?void 0:n.follow_unread)||0:((null===(i=e.data)||void 0===i?void 0:i.follow_unread)||0)+((null===(o=e.data)||void 0===o?void 0:o.unfollow_unread)||0)}));case 2:t.notifyCounts.message=e.sent,localStorage.setItem("imNotifyCounts".concat(t.uid),JSON.stringify(t.notifyCounts)),localStorage.setItem("unreadApiRequestedBy".concat(t.uid,"At"),Date.now());case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),i?o():parseInt(localStorage.getItem("unreadApiRequestedBy".concat(t.uid,"At")))+6e4>Date.now()?(r=JSON.parse(localStorage.getItem("imNotifyCounts".concat(t.uid)))||{},t.notifyCounts.message=parseInt(r.message)||0):o();case 3:case"end":return n.stop()}}),n)})))()},getnotifyCounts:function(){var e=this;return Object(c.a)({addPlatInfo:!0,url:"//api.bilibili.com/x/msgfeed/unread",method:"get"}).then((function(t){0===t.code&&(e.notifyCounts=Object.assign(e.notifyCounts,{at_me:t.data.at,reply_me:t.data.reply,praise_me:t.data.like,notify_me:t.data.sys_msg}))}))},getNotifyType:function(){var e=this;return Object(c.a)({addPlatInfo:!0,url:"//api.vc.bilibili.com/link_setting/v1/link_setting/get",method:"get",data:{msg_notify:1,show_unfollowed_msg:1}}).then((function(t){0===t.code&&(e.notifyType=t.data.msg_notify,e.unfollowFold=1===Number(t.data.show_unfollowed_msg))}))},postMessage:function(){var e=this,t=Object.keys(this.notifyCounts).reduce((function(t,n){return t+e.notifyCounts[n]}),0);window.parent.postMessage({type:"nav-im-update",count:t,notifyType:Math.max(this.notifyType-1,0)},"*")},displayCount:function(e){return e>99?"99+":e}}},g=n(0),y=Object(g.a)(h,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"im-root"},[n("div",{staticClass:"im-list-box"},e._l(e.im_list,(function(t){return n("a",{key:t.name,staticClass:"im-list",attrs:{href:t.href,target:"_blank"}},[e._v("\n      "+e._s(t.text)+"\n      "),3!==e.notifyType&&e.notifyCounts[t.name]>0?n("span",{staticClass:"im-notify im-number im-center"},[e._v(e._s(e.displayCount(e.notifyCounts[t.name])))]):e._e()])})),0)])}),[],!1,null,null,null).exports;o.a.config.productionTip=!1,new o.a({render:function(e){return e(y)}}).$mount("#nav-im-part")},6:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i={API_LIVE:"//api.live.bilibili.com",API_VC:"//api.vc.bilibili.com",API_MAIN:"//api.bilibili.com",API_VC_CO:"//api.vc.bilibili.co",API_MAIN_CO:"//api.bilibili.co",MAIN:"//www.bilibili.com",SPACE:"//space.bilibili.com",PASSPORT:"//passport.bilibili.com",BANGUMI:"//bangumi.bilibili.com",DATA:"//data.bilibili.com",T:"//t.bilibili.com",H:"//h.bilibili.com",VC:"//vc.bilibili.com",APP:"//app.bilibili.com",MESSAGE:"//message.bilibili.com",LINK:"//link.bilibili.com",M:"//m.bilibili.com",LIVE:"//live.bilibili.com"}},7:function(e,t,n){"use strict";n.d(t,"a",(function(){return V}));n(4),n(9);var i=n(17),o=n(60),r=n.n(o).a.create({timeout:"undefined"==typeof window?1e3:0});n(10),n(47),n(57),n(58),n(32),n(41),n(42);function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var s=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"对不起，服务器开小差了~ (ಥ﹏ಥ)",r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"error",s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:-8888,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:{};if(c(this,e),"object"===a(o)){var f="对不起，服务器开小差了~ (ಥ﹏ಥ)";o.response?f="".concat(o.response.statusText," ").concat(o.response.status):"ECONNABORTED"===o.code&&(f="接口超时，稍后再试试吧~ (ಥ﹏ಥ)"),this.msg=f}else this.msg=o;this.type=r,this.code=s,this.data=u,this.url=n,this.payload=i,this.cost=t},u=n(15),f=Object(u.c)(),l="IE 9"===f||"IE Legacy"===f,d=l||"IE 10"===f||"IE 11"===f;n(3),n(21),n(18);var p={};var m={},h=function(){var e=Math.random();return m[e]=Date.now(),e},g=function(e){if(!e)return 0;if(m[e]){var t=Date.now()-m[e];return delete m[e],t}return 0};n(31),n(22);var y=function(e,t){var n=new RegExp("[?&]".concat(t,"=([^&#]+)"));return(e.match(n)||[])[1]||""},v=(n(16),n(6)),w=n(27),b=n.n(w);function _(e){if(!e)return e;var t=e;if(!("undefined"!=typeof FormData&&t instanceof FormData)){var n={};if("undefined"!=typeof window){var i=y(window.location.href,"lang");if(i){var o="iphone";(/Android/i.test(navigator.userAgent)||/Linux/i.test(navigator.userAgent))&&(o="android"),n.lang=i,n.mobi_app="".concat(o,"_i")}}e=t=Object.assign(n,t),d&&(e._=(new Date).getTime())}return e}n(48);function C(e,t){if("string"==typeof e){var n=e.replace(/("\w*":)\s*(\d{16}\d*)/g,'$1"$2"').replace(/(\\"\w*\\":)\s*(\d{16}\d*)/g,'$1\\"$2\\"').replace(/("\w*":)\s*(\[\s*(\d{16}\d*)\s*(,\s*(\d{16}\d*)\s*)*])/g,(function(e,t,n){return"".concat(t).concat(n.trim().replace(/\[\s*/,'["').replace(/\s*]\s*/,'"]').replace(/\s*,\s*/g,'","'))})).replace(/(\\"\w*\\":)\s*(\[\s*(\d{16}\d*)\s*(,\s*(\d{16}\d*)\s*)*])/g,(function(e,t,n){return"".concat(t).concat(n.trim().replace(/\[\s*/,'[\\"').replace(/\s*]/,'\\"]').replace(/\s*,\s*/g,'\\",\\"'))}));if(t)try{e=JSON.parse(n)}catch(e){}else e=n}return e}function x(e){return C(e,!1)}var S=function(e){return C(e,!0)},O=n(61),A=n.n(O);function I(e,t,n,i,o,r){var a=r?e:e.data;return new Promise((function(e,r){var c,u,f=function(){return 0===a[c]};t.indexOf(v.a.SPACE)>=0?(c="status",u="result",f=function(){return!0===a[c]}):t.indexOf(v.a.BANGUMI)>=0?(c="code",u="result"):t.indexOf(v.a.PASSPORT)>=0?(c="code",u="access_info"):(c="code",u="data"),void 0===a||void 0===a[c]?r(new s(o,t,n)):f()?e(new s(o,t,n,"请求成功","success",0,i?a:a[u])):r(new s(o,t,n,a.message||a.msg||"电波无法到达~ ".concat(a.message||a.msg||a.code),"caution",a[c],a[u]))}))}n(117),n(118);function j(e,t,n){return(j=k()?Reflect.construct:function(e,t,n){var i=[null];i.push.apply(i,t);var o=new(Function.bind.apply(e,i));return n&&P(o,n.prototype),o}).apply(null,arguments)}function k(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function P(e,t){return(P=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function M(e,t,n){for(var i=arguments.length,o=new Array(i>3?i-3:0),r=3;r<i;r++)o[r-3]=arguments[r];return Promise.reject(j(s,[e,t,n].concat(o)))}n(26),n(44);function E(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var T=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.store={};var t={},n={};if("undefined"!=typeof window&&window.localStorage)try{t=JSON.parse(window.localStorage.getItem("bpapi_cache"))||t}catch(e){}var i=(new Date).getTime();Object.keys(t).forEach((function(e){var o=t[e];o&&i-o.ts<o.ttl&&i-o.ts<36e4&&(n[e]=o)})),n.uniqueKey=t.uniqueKey,this.store=n,this.setLocalCache()}var t,n,i;return t=e,(n=[{key:"set",value:function(e,t,n,i,o){var r=this;return(!o||this.store.uniqueKey!==o||"0"===o)&&n>0&&(this.clearCache(),this.store={}),o&&(this.uniqueKey=o,this.store.uniqueKey=o),new Promise((function(a,c){try{var s={};s.response=t,s.ttl=n>0?n:0,s.ts=(new Date).getTime(),r.store[e]=s,i&&n>0&&o&&"0"!==o&&r.setLocalCache(),a({status:"success"})}catch(e){c({status:"failed",data:e})}}))}},{key:"get",value:function(e,t,n){var i=this;return(!n||this.store.uniqueKey!==n||"0"===n)&&t>0&&(this.clearCache(),this.store={}),n&&(this.uniqueKey=n,this.store.uniqueKey=n),new Promise((function(n,o){try{var r=i.store[e],a=(new Date).getTime();r&&a-r.ts<(t>0?t:0)&&a-r.ts<36e4?n({status:"success",data:r.response}):o({status:"failed",data:r})}catch(e){o({status:"failed",data:e})}}))}},{key:"clearCache",value:function(){"undefined"!=typeof window&&window.localStorage&&window.localStorage.removeItem("bpapi_cache")}},{key:"setLocalCache",value:function(){this.uniqueKey&&(this.store.uniqueKey=this.uniqueKey),"undefined"!=typeof window&&window.localStorage&&this.uniqueKey&&window.localStorage.setItem("bpapi_cache",JSON.stringify(this.store))}}])&&E(t.prototype,n),i&&E(t,i),e}(),N=function(){return new T}(),R=(n(34),"undefined"==typeof window);var D=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("undefined"!=typeof FormData&&e instanceof FormData){for(var n in t)t.hasOwnProperty(n)&&(FormData.prototype.set?e.set(n,t[n]):e.append(n,t[n]));return e}return Object.assign(e,t)},U=function(e){return new Promise((function(t){if(e.addPlatInfo)if(i.inBiliApp){e.data=D(e.data,function(){if("undefined"==typeof navigator)return{};var e=navigator.userAgent;return{build:e.match(/BiliApp\/([^ ]*)/)?e.match(/BiliApp\/([^ ]*)/)[1]:10,mobi_app:e.match(/mobi_app\/([^ ]*)/)[1]}}());try{i.biliBridge.callNative({method:"global.getContainerInfo",callback:function(n){e.data=D(e.data,{build:n.build,mobi_app:n.mobi_app}),t(e)}})}catch(n){t(e)}}else e.data=D(e.data,{build:0,mobi_app:"web"}),t(e);else t(e)}))},B="undefined"!=typeof window&&window.BiliAjax?window.BiliAjax.default:A.a,F=new B({transformResponse:x,oldAppUseAxios:!0,newAppUseV2:!0,transformHeaders:function(){return{"Content-Type":"application/json"}},qsConfig:{jsonStringify:!0}}),L=new B({transformResponse:x,oldAppUseAxios:!0}),q=function(e){if("undefined"!=typeof FormData&&e.data instanceof FormData)return r(_(e));var t=Object.assign({},e);switch(delete t.data,delete t.url,e.method.toLowerCase()){case"get":return(e.ajaxVersion2?F:L).get(e.url,_(e.data),t);case"post":return(e.ajaxVersion2?F:L).post(e.url,_(e.data),t);default:return r(_(e))}};function K(e){var t=e.useBridgeProxy,n=e.urlWithCSRF,i=h(),o=0,a=e.url+JSON.stringify(e.data||"");return N.get(a,e.ttl,String(e.cache_key||"")).then((function(n){return o=g(i),I(n.data,e.url,e.data,e.needOriginal,o,t)})).catch((function(){return U(e).then((function(e){var i=t?q:r,o=function(e){var t="";if(R)return t;var n=document.cookie;if(!n)return t;for(var i=n.split(";"),o=new RegExp("^".concat(e,"=")),r=0;r<i.length;r++){var a=i[r].trim();if(o.test(a)){t=a.split("=")[1];break}}return t}("bili_jct");return n&&(e.url=e.url.indexOf("?")>0&&o?"".concat(e.url,"&csrf=").concat(o):"".concat(e.url,"?csrf=").concat(o)),function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return function(){if(p[e]&&i>0)return p[e];setTimeout((function(){p[e]=null}),i);for(var o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return p[e]=t.apply(n,r),p[e]}}(a,i,e.throttleInterval)(e)})).then((function(n){return N.set(a,n,e.ttl,e.localCache,String(e.cache_key||"")).then((function(){return o=g(i),I(n,e.url,e.data,e.needOriginal,o,t)}))}),(function(){o=g(i);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return M.apply(void 0,[o,e.url,e.data].concat(n))}))}))}var J=n(62),$=n.n(J);i.inBiliApp&&(Object(i.initEnv)(),i.biliBridge.callNative({method:"global.import",data:{namespace:"net"}})),r.interceptors.request.use((function(e){if(!e)return e;var t=e.method,n=e.url,i=e.data;e.withCredentials=!0;var o=i||{},r="string"==typeof t&&"post"===t.toLowerCase();if(r){var a=u.a.getItem("bili_jct")||"";o.csrf_token=a,o.csrf=a}if(!("undefined"!=typeof FormData&&o instanceof FormData)){var c={};if("undefined"!=typeof window){var s=y(window.location.href,"lang");if(s){var f="iphone";(/Android/i.test(navigator.userAgent)||/Linux/i.test(navigator.userAgent))&&(f="android"),c.lang=s,c.mobi_app="".concat(f,"_i")}}o=Object.assign(c,o),r?e.data=Object(w.stringify)(o):(e.params=o,d&&(e.params._=(new Date).getTime()),delete e.data),"undefined"==typeof window&&/^\/\//.test(n)&&(e.url="http:".concat(n))}return e}));var V=function(e){"undefined"==typeof window||window.Promise||console.warn("No window.Promise. @bplus-common/components.bpapi need a promise polyfill.");var t=(e.method||"get").toLowerCase(),n=l&&!function(e){if("undefined"==typeof window)return!1;var t=e.replace(/^(https?:)?(\/\/)?/,"").match(window.location.hostname);return t&&0===t.index}(e.url),i="jsonp"===t;return!i&&n?M(e.url,e.data,"少年啊，你的浏览器太老了辣","caution",-8889):(e.method=t,e.transformResponse=e.transformResponse||[S],i?function(e){var t=h(),n=0,i=e.url,o=/^(http:|https:)?\/\/api\.(live)|(vc)/.test(i),r=e.data&&"[object Object]"===e.data.toString();e.jsonpCallback||!r||"type"in e.data||"jsonp"in e.data?e.jsonpCallback||r||(e.data={type:"jsonp",jsonp:"jsonp"}):(e.data.type="jsonp",e.data.jsonp="jsonp");var a=e.data||{},c={},s="zh_CN";if("undefined"!=typeof window&&(s=y(window.location.href,"lang"))){c.lang=s;var u="iphone";(/Android/i.test(navigator.userAgent)||/Linux/i.test(navigator.userAgent))&&(u="android"),"zh_CN"!==s&&(c.mobi_app="".concat(u,"_i"))}a=Object.assign(c,a);var f=e.data&&e.jsonpCallback||(o?"_cb":"callback"),l=b.a.stringify(a),d=l.length>0?"".concat(i,"?").concat(l):"".concat(i),p=i+JSON.stringify(e.data||"");return N.get(p,e.ttl,String(e.cache_key||"")).then((function(o){return n=g(t),I({data:o.data},i,e.data,e.needOriginal,n)})).catch((function(){return $()(d,{jsonpCallback:f}).then((function(o){return o.ok?o.json().then((function(o){return N.set(p,o,e.ttl,e.localCache,String(e.cache_key||"")).then((function(){return n=g(t),I({data:o},i,e.data,e.needOriginal,n)}))}),(function(){n=g(t);for(var i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];return M.apply(void 0,[n,e.url,e.data].concat(o))})):M(n=g(t),e.url,e.data)}),(function(){n=g(t);for(var i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];return M.apply(void 0,[n,e.url,e.data].concat(o))}))}))}(e):K(e))}}})}));